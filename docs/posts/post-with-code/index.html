<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.319">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Luis Ortiz-Cevallos">
<meta name="dcterms.date" content="2023-04-14">

<title>LUIS ORTIZ CEVALLOS - MODELOS SEMI ESTRUCTURALES PARA EL CRÉDITO AL CONSUMO</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">LUIS ORTIZ CEVALLOS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">MODELOS SEMI ESTRUCTURALES PARA EL CRÉDITO AL CONSUMO</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">news</div>
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://ortiz-cevallos.github.io/MYSELF/">Luis Ortiz-Cevallos</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 14, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="aplicación-para-guatemala" class="level1">
<h1>Aplicación para Guatemala</h1>
<section id="blanchard-quah-ortogonalización-restricciones-sobre-c1" class="level2">
<h2 class="anchored" data-anchor-id="blanchard-quah-ortogonalización-restricciones-sobre-c1">Blanchard-Quah ortogonalización (restricciones) sobre C(1)</h2>
<p>Al observar la evolución del crédito hacia consumo provisto por el sistema bancario guatemalteco y disponible en <span class="citation" data-cites="SECMCADATOS">@SECMCADATOS</span>, se observa una series con una tendendencia estocástica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"zoo"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"xts"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantmod)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#CARGAMOS DATOS MENSUALES</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>DATA_MES<span class="ot">&lt;-</span><span class="fu">as.xts</span>(<span class="fu">read.zoo</span>(<span class="st">"GT_MES.csv"</span>, <span class="at">index.column =</span> <span class="dv">1</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>CREDITO<span class="ot">&lt;-</span>DATA_MES<span class="sc">$</span>CRED</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>CREDITO<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(CREDITO), <span class="fu">coredata</span>(CREDITO))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>CREDITO<span class="ot">&lt;-</span><span class="fu">filter</span>(CREDITO, date <span class="sc">&gt;=</span> <span class="st">"2008-01-01"</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(CREDITO)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"CREDITO"</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>CREDITO<span class="ot">&lt;-</span><span class="fu">mutate</span>(CREDITO, <span class="at">CONSUMO=</span><span class="fu">log</span>(CREDITO))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>G<span class="ot">&lt;-</span><span class="fu">ggplot</span>(CREDITO, <span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>CONSUMO))</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>G<span class="ot">&lt;-</span>G<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Logaritmo"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">"Fecha"</span>, <span class="at">title =</span> <span class="st">"Guatemala: evolución del crédito al consumo"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"https://www.secmca.org/wp-content/uploads/2023/03/REPORTE_INDICADO</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">RES_BANCARIOS_MARZO_2023.xlsx"</span>)<span class="sc">+</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>G</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>El proceso de generación de la serie del crédito al consumo puede explicarse a través de la identificación de diferentes innovaciones. Una de ellas, las llamaré tecnológicas (en general uso ese término para referir los factores que pueden producir una mayor inclusión financiera independientemente si es producto de políticas o nuevas tecnologías), la segunda las de denanda y la tercera de absorción fiscal.</p>
<p>Para este ejercicio de identificación sigo la metodología propuesta por <span class="citation" data-cites="BLANCHARD88">@BLANCHARD88</span> y estimo la forma reducida de un Vector Autorregresivo integrado por la tasa de crecimiento de la cartera de consumo nominal (<span class="math inline">\(\Delta c_{t}\)</span>), la tasa de crecimiento del PIB (<span class="math inline">\(\Delta y_{t}\)</span>) y el porcentaje de los activos de los sistemas bancarios en títulos y valores públicos (<span class="math inline">\(\Delta y_{t}\)</span>). La representación de este VAR como un proceso de media móviles está dado por:</p>
<p><span class="math display">\[\begin{equation}
X_{t}=\left( \begin{array}{c}
\Delta c_{t} \\
\Delta y_{t} \\
\Delta x_{t}
\end{array}
\right)=A(L)e_{t}
\label{e1}
\end{equation}\]</span></p>
<p>Considero <span class="math inline">\(A(0)=I\)</span> y <span class="math inline">\(\Sigma_e=E(e e^{\tau})\)</span> como la matriz de varianza y covarianza de la forma reducida del VAR mostrado en <span class="math inline">\(\ref{e1}\)</span>. Y supongo, primero que el crédito hacia consumo, la actividad económica y la exposición del sistema bancario hacia valores del gobierno son producidos a través de tres procesos estructurales independientes con shocks de varianza unitaria. Y segundo, que uno de esos procesos, el de las innovaciones tecnológicas, es el responsable de la tendencia estocástica observada en el crédito para consumo. Con base en lo anterior defino un VAR estructural cuya representación como un proceso de medias móviles es el siguiente:</p>
<p><span class="math display">\[\begin{equation}
X_{t}=C(L)\epsilon_{t}=\left( \begin{array}{ccc}
C_{1,1}(L) &amp; C_{1,2}(L) &amp; C_{1,3}(L)\\
C_{2,1}(L) &amp; C_{2,2}(L) &amp; C_{2,3}(L)\\
C_{3,1}(L) &amp; C_{3,2}(L) &amp; C_{3,3}(L)
\end{array}
\right)\epsilon_{t}
\label{e2}
\end{equation}\]</span></p>
<p>Siendo <span class="math inline">\(\Sigma_{\epsilon}=E(\epsilon \epsilon^{\tau})=I\)</span> la matriz de varianza y covarianza de los shocks estructurales, los cuales son independientes y con varianza unitaria, y <span class="math inline">\(C_{1,2}(1)=C_{1,3}(1)=0\)</span>, indicando que el shock de demanda y fiscal sobre las variables tasa de crecimiento del PIB y porcentaje de activos invertidos en valores soberanos, en su orden, no tienen efectos de largo plazo en el crédito nominal para consumo.</p>
<p>El proceso y resultado de la estimación es el siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>CRED       <span class="ot">&lt;-</span>DATA_MES<span class="sc">$</span>CRED</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>FISCAL     <span class="ot">&lt;-</span>DATA_MES<span class="sc">$</span>PUB</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>CRED       <span class="ot">&lt;-</span>CRED[<span class="st">"2008-01-01/2022-09-01"</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>ep1        <span class="ot">&lt;-</span><span class="fu">endpoints</span>(CRED , <span class="at">on =</span> <span class="st">"quarters"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>CRED       <span class="ot">&lt;-</span><span class="fu">period.apply</span>(CRED  , <span class="at">INDEX =</span> ep1, <span class="at">FUN =</span> sum)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>DCRED      <span class="ot">&lt;-</span><span class="fu">diff</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">log</span>(CRED ), <span class="at">lag=</span><span class="dv">4</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>FISCAL     <span class="ot">&lt;-</span>FISCAL[<span class="st">"2008-01-01/2022-09-01"</span>]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>ep2        <span class="ot">&lt;-</span><span class="fu">endpoints</span>(FISCAL , <span class="at">on =</span> <span class="st">"quarters"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>TASA       <span class="ot">&lt;-</span><span class="fu">period.apply</span>(FISCAL, <span class="at">INDEX =</span> ep2, <span class="at">FUN =</span> max)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>DATA_TRIM   <span class="ot">&lt;-</span><span class="fu">as.xts</span>(<span class="fu">read.zoo</span>(<span class="st">"TRIM_GT.csv"</span>, <span class="at">index.column =</span> <span class="dv">1</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">sep =</span> <span class="st">";"</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">format =</span> <span class="st">"%Y-%m-%d"</span>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>PIB         <span class="ot">&lt;-</span>DATA_TRIM<span class="sc">$</span>PIB</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>PIB         <span class="ot">&lt;-</span>PIB[<span class="st">"2001-03-01/2022-09-01"</span>]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>DPIB        <span class="ot">&lt;-</span><span class="fu">diff</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">log</span>(PIB), <span class="at">lag=</span><span class="dv">4</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">#COMBINAR</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">merge</span>(DCRED, DPIB,<span class="at">join=</span><span class="st">"left"</span>)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">merge</span>(BASE,  FISCAL,<span class="at">join=</span><span class="st">"left"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>BASE       <span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">date=</span><span class="fu">index</span>(BASE), <span class="fu">coredata</span>(BASE))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(BASE)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"date"</span>,<span class="st">"c"</span>, <span class="st">"y"</span>, <span class="st">'x'</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>DATA       <span class="ot">&lt;-</span>dplyr<span class="sc">::</span><span class="fu">select</span>(BASE, date, c,y,x)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(DATA)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"date"</span>, <span class="st">"c"</span>, <span class="st">"y"</span>, <span class="st">'x'</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>DATA       <span class="ot">&lt;-</span><span class="fu">filter</span>(DATA, date <span class="sc">&gt;=</span> <span class="st">"2016-03-01"</span>)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>DATA       <span class="ot">&lt;-</span><span class="fu">xts</span>(DATA[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">order.by=</span><span class="fu">as.Date</span>(DATA[,<span class="dv">1</span>], <span class="st">"%Y/%m/%d"</span>))</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"svars"</span>)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>VAR        <span class="ot">&lt;-</span> vars<span class="sc">::</span><span class="fu">VAR</span>(DATA[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)],<span class="at">p =</span><span class="dv">2</span>,<span class="at">type =</span> <span class="st">"const"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>VAR<span class="sc">$</span>varresult<span class="sc">$</span>c<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       c.l1        y.l1        x.l1        c.l2        y.l2        x.l2 
 1.12127681  0.15372782  0.29159136 -0.11201301 -0.01109658  0.18036079 
      const 
-9.91395632 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>VAR<span class="sc">$</span>varresult<span class="sc">$</span>y<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       c.l1        y.l1        x.l1        c.l2        y.l2        x.l2 
-0.25412909  0.57678412  0.39960337  0.27004423 -0.15357170 -0.02784201 
      const 
-5.84527946 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>VAR<span class="sc">$</span>varresult<span class="sc">$</span>x<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       c.l1        y.l1        x.l1        c.l2        y.l2        x.l2 
 0.18016081 -0.13225215  0.28849915 -0.26998876 -0.03531496  0.45762387 
      const 
 6.70493277 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>SIGMA<span class="ot">&lt;-</span><span class="fu">summary</span>(VAR)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>SIGMA<span class="sc">$</span>covres</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          c         y         x
c 1.2422579  2.067672 0.1369263
y 2.0676722 13.450295 0.5679060
x 0.1369263  0.567906 1.6557099</code></pre>
</div>
</div>
<p>Habiendo estimado el VAR a continuación encontramos las restricciones de corto o contemporáneas y largo plazo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>BQMODEL<span class="ot">&lt;-</span> <span class="fu">BQ</span>(VAR)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BQMODEL)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SVAR Estimation Results:
======================== 

Call:
BQ(x = VAR)

Type: Blanchard-Quah 
Sample size: 25 
Log Likelihood: -144.025 

Estimated contemporaneous impact matrix:
        c      y       x
c 0.45904 0.3686 -0.9464
y 0.08455 3.5899 -0.7455
x 1.15782 0.2366  0.5091

Estimated identified long run impact matrix:
        c      y     x
c 16.7627  0.000 0.000
y -0.1924  4.788 0.000
x -1.2435 -2.228 2.005

Covariance matrix of reduced form residuals (*100):
       c       y      x
c 124.23  206.77  13.69
y 206.77 1345.03  56.79
x  13.69   56.79 165.57</code></pre>
</div>
</div>
<p>En seguida, calculamos la función impulso respuesta para cada variable, teniendo en cuenta que el PIB y la proporción de activos del sistema bancario invertidos en títulos y valores del gobierno no sufren en el largo plazo ningún efecto de los tres shocks estructurales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>FIR_BQ <span class="ot">&lt;-</span> <span class="fu">irf</span>(BQMODEL,<span class="at">n.ahead =</span> <span class="dv">32</span>, <span class="at">impulse =</span> <span class="fu">c</span>( <span class="st">"c"</span>, <span class="st">"y"</span>, <span class="st">"x"</span>), <span class="at">boot =</span><span class="cn">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tecno  <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">cumsum</span>(FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>c[, <span class="dv">1</span>]), FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>c[, <span class="dv">2</span>],  FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>c[, <span class="dv">3</span>])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>RESULTADO1<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(tecno)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>PERIODO<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">33</span>,<span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>RESULTADO1 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO1,PERIODO)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">"Tecnológico"</span>,<span class="dv">33</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>RESULTADO1 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO1,CODE)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">######################################</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>demanda <span class="ot">&lt;-</span> <span class="fu">cbind</span>(FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>y[, <span class="dv">1</span>], FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>y[, <span class="dv">2</span>],  FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>y[, <span class="dv">3</span>])</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>RESULTADO2<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(demanda)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,PERIODO)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">"Demanda"</span>,<span class="dv">33</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>RESULTADO2 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO2,CODE)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="do">######################################</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>fiscal <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>x[, <span class="dv">1</span>], <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>x[, <span class="dv">2</span>], <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>FIR_BQ<span class="sc">$</span>irf<span class="sc">$</span>x[, <span class="dv">3</span>])</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>RESULTADO3 <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(fiscal)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>RESULTADO3 <span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO3,PERIODO)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>CODE<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="st">"Fiscal"</span>,<span class="dv">33</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>RESULTADO3<span class="ot">&lt;-</span><span class="fu">cbind</span>(RESULTADO3,CODE)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>RESULTADO <span class="ot">&lt;-</span><span class="fu">rbind</span>(RESULTADO1,RESULTADO2,RESULTADO3)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>BASE_LONG <span class="ot">&lt;-</span> <span class="fu">gather</span>(RESULTADO, <span class="at">key=</span><span class="st">"measure"</span>, <span class="at">value=</span><span class="st">"value"</span>,<span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>))</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>measure <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>measure,<span class="at">levels =</span> ,<span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>))</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>BASE_LONG<span class="sc">$</span>CODE <span class="ot">&lt;-</span> <span class="fu">factor</span>(BASE_LONG<span class="sc">$</span>CODE,<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Tecnológico"</span>, <span class="st">"Demanda"</span>, <span class="st">"Fiscal"</span>))</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>variable_names <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tecnológico"</span> <span class="ot">=</span> <span class="st">"Shock tecnológicos"</span>, </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Demanda"</span> <span class="ot">=</span> <span class="st">"Shock de demanda"</span>,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Fiscal"</span> <span class="ot">=</span> <span class="st">"Shock fiscal"</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>variable_labeller2 <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (variable<span class="sc">==</span><span class="st">'CODE'</span>) {</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(variable_names[value])</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(region_names)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>paleta<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>, <span class="st">"burlywood"</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span><span class="fu">ggplot</span>(BASE_LONG, <span class="fu">aes</span>(<span class="at">x=</span>PERIODO, <span class="at">y=</span>value, <span class="at">group =</span> measure,</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>                         <span class="at">colour=</span>measure))<span class="sc">+</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>CODE, <span class="at">scales=</span><span class="st">"free"</span>, <span class="at">labeller=</span> variable_labeller2)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Respuesta (%)"</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">x=</span><span class="st">"Períodos (trimestres)"</span>, <span class="at">title =</span> <span class="st">"Guatemala: funciones impulso respuestas"</span>,</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">caption =</span> <span class="st">"Elaboración propia con base en: https://www.secmca.org/wp-content/uploads/2023/03/REPORTE_INDICADO</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="st">RES_BANCARIOS_MARZO_2023.xlsx"</span>)<span class="sc">+</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span>paleta,</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Crédito para consumo"</span>,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Producto"</span>,</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Proporción de los activos invertidos en valores públicos"</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">&lt;-</span>Z<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.line.x =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.left  =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.line.y.right =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.x  =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.text.y  =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title.x =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">axis.title.y =</span> <span class="fu">element_text</span>( <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.border =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>           <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.key=</span><span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"white"</span>,</span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>),</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.spacing.x =</span> <span class="fu">unit</span>(<span class="fl">0.10</span>, <span class="st">'cm'</span>),</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.margin=</span><span class="fu">margin</span>(),</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>           <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"transparent"</span>,</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">inherit.blank =</span> <span class="cn">FALSE</span>),</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>           <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">20</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">face =</span> <span class="st">"bold.italic"</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span><span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">32</span>,<span class="dv">4</span>))</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>Z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Inplicaciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Descomposición de la varianza HISTÓRICA</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">##FUNCIONES</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>VARhd <span class="ot">&lt;-</span> <span class="cf">function</span>(Estimation){</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## make X and Y</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  nlag    <span class="ot">&lt;-</span> Estimation<span class="sc">$</span>p   <span class="co"># number of lags</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  DATA    <span class="ot">&lt;-</span> Estimation<span class="sc">$</span>y   <span class="co"># data</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  QQ      <span class="ot">&lt;-</span> <span class="fu">VARmakexy</span>(DATA,nlag,<span class="dv">1</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#invA   &lt;- t(chol(as.matrix(summary(Estimation)$covres)))# inverse of the A matrix</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  invA    <span class="ot">&lt;-</span> BQMODEL<span class="sc">$</span>LRIM</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#invA   &lt;- bqfactor</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  Fcomp   <span class="ot">&lt;-</span> <span class="fu">companionmatrix</span>(Estimation)                   <span class="co"># Companion matrix</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#det    &lt;- c_case                                       # constant and/or trends</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  F1      <span class="ot">&lt;-</span> <span class="fu">t</span>(QQ<span class="sc">$</span>Ft)                                     <span class="co"># make comparable to notes</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  eps     <span class="ot">&lt;-</span> <span class="fu">ginv</span>(invA) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">residuals</span>(Estimation))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># structural errors</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  nvar    <span class="ot">&lt;-</span> Estimation<span class="sc">$</span>K                                 <span class="co"># number of endogenous variables</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  nvarXeq <span class="ot">&lt;-</span> nvar <span class="sc">*</span> nlag                                  <span class="co"># number of lagged endogenous per equation</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  nvar_ex <span class="ot">&lt;-</span> <span class="dv">0</span>                                                <span class="co"># number of exogenous (excluding constant and trend)</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  Y       <span class="ot">&lt;-</span> QQ<span class="sc">$</span>Y                                             <span class="co"># left-hand side</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#X     &lt;- QQ$X[,(1+det):(nvarXeq+det)]                    # right-hand side (no exogenous)</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  nobs    <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Y)                                          <span class="co"># number of observations</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Compute historical decompositions</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contribution of each shock</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  invA_big    <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nvarXeq,nvar)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  invA_big[<span class="dv">1</span><span class="sc">:</span>nvar,] <span class="ot">&lt;-</span> invA</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  Icomp       <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(nvar), <span class="fu">matrix</span>(<span class="dv">0</span>,nvar,(nlag<span class="dv">-1</span>)<span class="sc">*</span>nvar))</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  HDshock_big <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim=</span><span class="fu">c</span>(nlag<span class="sc">*</span>nvar,nobs<span class="sc">+</span><span class="dv">1</span>,nvar))</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  HDshock     <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim=</span><span class="fu">c</span>(nvar,(nobs<span class="sc">+</span><span class="dv">1</span>),nvar))</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nvar){  <span class="co"># for each variable</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    eps_big <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nvar,(nobs<span class="sc">+</span><span class="dv">1</span>)) <span class="co"># matrix of shocks conformable with companion</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    eps_big[j,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(eps_big)] <span class="ot">&lt;-</span> eps[j,]</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(nobs<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>      HDshock_big[,i,j] <span class="ot">&lt;-</span> invA_big <span class="sc">%*%</span> eps_big[,i] <span class="sc">+</span> Fcomp <span class="sc">%*%</span> HDshock_big[,(i<span class="dv">-1</span>),j]</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>      HDshock[,i,j] <span class="ot">&lt;-</span>  Icomp <span class="sc">%*%</span> HDshock_big[,i,j]</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>  HD.shock <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim=</span><span class="fu">c</span>((nobs<span class="sc">+</span>nlag),nvar,nvar))   <span class="co"># [nobs x shock x var]</span></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nvar){</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nvar){</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>      HD.shock[,j,i] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,nlag), HDshock[i,(<span class="dv">2</span><span class="sc">:</span><span class="fu">dim</span>(HDshock)[<span class="dv">2</span>]),j])</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(HD.shock)</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="do">##########</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>VARmakexy <span class="ot">&lt;-</span> <span class="cf">function</span>(DATA,lags,c_case){</span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  nobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(DATA)</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Y matrix</span></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> DATA[(lags<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(DATA),]</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> DATA[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>lags),]</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#X-matrix</span></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (c_case<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(lags<span class="dv">-1</span>)){</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DATA[(jj<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(nobs<span class="sc">-</span>lags<span class="sc">+</span>jj),])</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(c_case<span class="sc">==</span><span class="dv">1</span>){ <span class="co">#constant</span></span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(lags<span class="dv">-1</span>)){</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DATA[(jj<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(nobs<span class="sc">-</span>lags<span class="sc">+</span>jj),])</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,(nobs<span class="sc">-</span>lags),<span class="dv">1</span>), X)</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(c_case<span class="sc">==</span><span class="dv">2</span>){ <span class="co"># time trend and constant</span></span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(lags<span class="dv">-1</span>)){</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>      X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DATA[(jj<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(nobs<span class="sc">-</span>lags<span class="sc">+</span>jj),])</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>    trend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X))</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,(nobs<span class="sc">-</span>lags),<span class="dv">1</span>), <span class="fu">t</span>(trend))</span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(X))</span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> (<span class="fu">as.matrix</span>(<span class="fu">t</span>(X)) <span class="sc">%*%</span> <span class="fu">as.matrix</span>(Y))</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>  Ft <span class="ot">&lt;-</span> <span class="fu">ginv</span>(A) <span class="sc">%*%</span> B</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>  retu <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">X=</span>X,<span class="at">Y=</span>Y, <span class="at">Ft=</span>Ft)</span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(retu)</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a>companionmatrix <span class="ot">&lt;-</span> <span class="cf">function</span> (x)</span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>(<span class="fu">class</span>(x) <span class="sc">==</span> <span class="st">"varest"</span>)) {</span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Please provide an object of class 'varest', generated by 'VAR()'.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> x<span class="sc">$</span>K</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> x<span class="sc">$</span>p</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">Acoef</span>(x))</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>  companion <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> K <span class="sc">*</span> p, <span class="at">ncol =</span> K <span class="sc">*</span> p)</span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>  companion[<span class="dv">1</span><span class="sc">:</span>K, <span class="dv">1</span><span class="sc">:</span>(K <span class="sc">*</span> p)] <span class="ot">&lt;-</span> A</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>    j <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> (K <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(K <span class="sc">*</span> p)) {</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>      j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>      companion[i, j] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(companion)</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>SERIE <span class="ot">&lt;-</span><span class="fu">fitted</span>(VAR)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>BQh<span class="ot">&lt;-</span><span class="fu">VARhd</span>(VAR)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>dates1<span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2016-03-01"</span>), <span class="at">length=</span><span class="fu">length</span>(SERIE[,<span class="dv">1</span>])<span class="sc">+</span><span class="dv">2</span>,<span class="at">by=</span><span class="st">"quarters"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>BQc_T<span class="ot">&lt;-</span>BQh[,<span class="dv">1</span>,<span class="dv">1</span>] <span class="co">#SHOCK TECNOLÓGICO SOBRE c</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>BQc_T<span class="ot">&lt;-</span><span class="fu">xts</span>(BQc_T, <span class="at">order.by=</span>dates1)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>BQc_D<span class="ot">&lt;-</span>BQh[,<span class="dv">1</span>,<span class="dv">2</span>] <span class="co">#SHOCK DEMANDA SOBRE c</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>BQc_D<span class="ot">&lt;-</span><span class="fu">xts</span>(BQc_D, <span class="at">order.by=</span>dates1)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>BQc_F<span class="ot">&lt;-</span>BQh[,<span class="dv">1</span>,<span class="dv">3</span>] <span class="co">#SHOCK DEMANDA2 SOBRE c</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>BQc_F<span class="ot">&lt;-</span><span class="fu">xts</span>(BQc_F, <span class="at">order.by=</span>dates1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>